import{_ as n}from"./plugin-vue_export-helper-c27b6911.js";import{o as s,c as a,f as e}from"./app-8da2a3ac.js";const t={},p=e(`<p>python excel 模块</p><h2 id="安装" tabindex="-1"><a class="header-anchor" href="#安装" aria-hidden="true">#</a> 安装</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code> $ pip <span class="token function">install</span> openpyxl
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="创建读取" tabindex="-1"><a class="header-anchor" href="#创建读取" aria-hidden="true">#</a> 创建读取</h2><h3 id="创建表" tabindex="-1"><a class="header-anchor" href="#创建表" aria-hidden="true">#</a> 创建表</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code> <span class="token keyword">from</span> openpyxl <span class="token keyword">import</span> Workbook

 wb <span class="token operator">=</span> Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>                                 <span class="token comment"># 创建一个工作表</span>
 sheet <span class="token operator">=</span> wb<span class="token punctuation">.</span>active                               <span class="token comment"># 激活第一个 sheet</span>
 sheet<span class="token punctuation">[</span><span class="token string">&#39;A1&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;hellow world&#39;</span>                    <span class="token comment"># sheet A1 赋值</span>
 wb<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">&#39;test.xlsx&#39;</span><span class="token punctuation">)</span>                            <span class="token comment"># 保存 excel 文件为 test.xlsx</span>
 wb<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>                                      <span class="token comment"># 关闭工作表</span>

 
 wb<span class="token punctuation">.</span>create_sheet<span class="token punctuation">(</span>name<span class="token punctuation">:</span><span class="token builtin">str</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> index<span class="token punctuation">:</span><span class="token builtin">int</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment"># 自定义 sheet 名称和位置 </span>
 wb<span class="token punctuation">.</span>create_sheet<span class="token punctuation">(</span><span class="token string">&#39;first_sheet&#39;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>               <span class="token comment"># 在 0 插入 名为 first_sheet 的表</span>
 sheet<span class="token punctuation">.</span>title                                     <span class="token comment"># 获取sheet 的名称, 也可以重新赋值</span>
 <span class="token operator">&gt;</span> first_sheet

 <span class="token keyword">for</span> sheet <span class="token keyword">in</span> wb<span class="token punctuation">:</span>                                <span class="token comment"># 遍历工作表, 打印所有表名称</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>sheet<span class="token punctuation">.</span>title<span class="token punctuation">)</span>

 wb<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>sheet<span class="token punctuation">)</span>                                <span class="token comment"># 删除 sheet, 参数是 sheet 对象</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="读取表" tabindex="-1"><a class="header-anchor" href="#读取表" aria-hidden="true">#</a> 读取表</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code> <span class="token keyword">from</span> openpyxl <span class="token keyword">import</span> load_workbook

 wb <span class="token operator">=</span> load_workbook<span class="token punctuation">(</span><span class="token string">&#39;test.xlsx&#39;</span><span class="token punctuation">)</span>                 <span class="token comment"># 打开一个已存在的 excel 文件</span>

 sheet_names <span class="token operator">=</span> wb<span class="token punctuation">.</span>sheetnames                     <span class="token comment"># 获取所有表名组成的列表</span>
 <span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token string">&#39;first&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;second&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;third&#39;</span><span class="token punctuation">]</span>

 sheet <span class="token operator">=</span> wb<span class="token punctuation">[</span><span class="token string">&#39;first&#39;</span><span class="token punctuation">]</span>                          
 sheet<span class="token punctuation">[</span><span class="token string">&#39;A1&#39;</span><span class="token punctuation">]</span>
 <span class="token operator">&gt;</span> <span class="token string">&#39;hellow world&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="读写" tabindex="-1"><a class="header-anchor" href="#读写" aria-hidden="true">#</a> 读写</h2><h3 id="赋值和读取" tabindex="-1"><a class="header-anchor" href="#赋值和读取" aria-hidden="true">#</a> 赋值和读取</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code> sheet<span class="token punctuation">[</span><span class="token string">&#39;A1&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;hellow world&#39;</span>                    <span class="token comment"># A1 赋值 hellow world</span>
 sheet<span class="token punctuation">[</span><span class="token string">&#39;A1&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value                               <span class="token comment"># 读取 A1 方格的值</span>
 <span class="token operator">&gt;</span> <span class="token string">&#39;hellow world&#39;</span> 

 grid <span class="token operator">=</span> sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token string">&#39;ok&#39;</span><span class="token punctuation">)</span>  <span class="token comment"># 第一列第一行赋值 ok, 返回一个 cell 对象</span>
 sheel<span class="token punctuation">.</span>cell<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value                          <span class="token comment"># 读取第一行第一列方格的值</span>
 <span class="token operator">&gt;</span> <span class="token string">&#39;ok&#39;</span>

 row_one <span class="token operator">=</span>  sheet<span class="token punctuation">[</span><span class="token string">&#39;A1&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;F1&#39;</span><span class="token punctuation">]</span>                    <span class="token comment"># 获取多数方格, 返回 cell 对象的元组</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="多行遍历" tabindex="-1"><a class="header-anchor" href="#多行遍历" aria-hidden="true">#</a> 多行遍历</h3><ul><li>sheet.iter_rows() 每次返回一整行组成的元组</li><li>sheet.iter_cols() 每次返回一整列组成的元组</li></ul><table><thead><tr><th style="text-align:center;">参数</th><th style="text-align:center;">含义</th></tr></thead><tbody><tr><td style="text-align:center;"><code>min_row</code></td><td style="text-align:center;">起始行, default:None</td></tr><tr><td style="text-align:center;"><code>max_row</code></td><td style="text-align:center;">结束行, default:None</td></tr><tr><td style="text-align:center;"><code>min_col</code></td><td style="text-align:center;">起始列, default:None</td></tr><tr><td style="text-align:center;"><code>max_col</code></td><td style="text-align:center;">结束列, default:None</td></tr><tr><td style="text-align:center;"><code>values_only</code></td><td style="text-align:center;">True:只返回值, False: 返回 cell 对象</td></tr></tbody></table><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>
 <span class="token keyword">for</span> row <span class="token keyword">in</span> sheet<span class="token punctuation">.</span>iter_rows<span class="token punctuation">(</span>                     
    min_row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> max_col<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> max_row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token comment"># 遍历第 1 至第 2 行, 取 3 列 </span>
    <span class="token keyword">for</span> cell <span class="token keyword">in</span> row<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>cell<span class="token punctuation">)</span>

 <span class="token operator">&lt;</span>Cell Sheet1<span class="token punctuation">.</span>A1<span class="token operator">&gt;</span>
 <span class="token operator">&lt;</span>Cell Sheet1<span class="token punctuation">.</span>B1<span class="token operator">&gt;</span>
 <span class="token operator">&lt;</span>Cell Sheet1<span class="token punctuation">.</span>C1<span class="token operator">&gt;</span>
 <span class="token operator">&lt;</span>Cell Sheet1<span class="token punctuation">.</span>A2<span class="token operator">&gt;</span>
 <span class="token operator">&lt;</span>Cell Sheet1<span class="token punctuation">.</span>B2<span class="token operator">&gt;</span>
 <span class="token operator">&lt;</span>Cell Sheet1<span class="token punctuation">.</span>C2<span class="token operator">&gt;</span>

 <span class="token keyword">for</span> col <span class="token keyword">in</span> sheet<span class="token punctuation">.</span>iter_cols<span class="token punctuation">(</span>
    min_row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> max_col<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> max_row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token comment"># 遍历第 1 至第 2 行, 取 3 列 </span>
    <span class="token keyword">for</span> cell <span class="token keyword">in</span> col<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>cell<span class="token punctuation">)</span>

<span class="token operator">&lt;</span>Cell Sheet1<span class="token punctuation">.</span>A1<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>Cell Sheet1<span class="token punctuation">.</span>A2<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>Cell Sheet1<span class="token punctuation">.</span>B1<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>Cell Sheet1<span class="token punctuation">.</span>B2<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>Cell Sheet1<span class="token punctuation">.</span>C1<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>Cell Sheet1<span class="token punctuation">.</span>C2<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="样式" tabindex="-1"><a class="header-anchor" href="#样式" aria-hidden="true">#</a> 样式</h2><h3 id="字体" tabindex="-1"><a class="header-anchor" href="#字体" aria-hidden="true">#</a> 字体</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code> <span class="token keyword">from</span> openpyxl<span class="token punctuation">.</span>styles <span class="token keyword">import</span> Font

 cell<span class="token punctuation">.</span>font <span class="token operator">=</span> Font<span class="token punctuation">(</span>
   name<span class="token operator">=</span><span class="token string">&quot;微软雅黑&quot;</span><span class="token punctuation">,</span>                                  <span class="token comment"># 字体</span>
   size<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">,</span>                                         <span class="token comment"># 字体大小</span>
   color<span class="token operator">=</span><span class="token string">&quot;0000FF&quot;</span><span class="token punctuation">,</span>                                  <span class="token comment"># 字体颜色，用16进制rgb表示</span>
   bold<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                                       <span class="token comment"># 是否加粗，True/False</span>
   italic<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                                     <span class="token comment"># 是否斜体，True/False</span>
   strike<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>                                     <span class="token comment"># 是否使用删除线，True/False</span>
   underline<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>                                  <span class="token comment"># 下划线, 可选&#39;singleAccounting&#39;, &#39;double&#39;, &#39;single&#39;, &#39;doubleAccounting&#39;</span>
 <span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="填充颜色" tabindex="-1"><a class="header-anchor" href="#填充颜色" aria-hidden="true">#</a> 填充颜色</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code> <span class="token keyword">from</span> openpyxl<span class="token punctuation">.</span>styles <span class="token keyword">import</span> PatternFill

 cell<span class="token punctuation">.</span>fill <span class="token operator">=</span> PatternFill<span class="token punctuation">(</span>
    patternType<span class="token operator">=</span><span class="token string">&quot;solid&quot;</span><span class="token punctuation">,</span>                         <span class="token comment"># 填充类型</span>
    fgColor<span class="token operator">=</span><span class="token string">&quot;F562a4&quot;</span><span class="token punctuation">,</span>                            <span class="token comment"># 前景色，16进制rgb</span>
    bgColor<span class="token operator">=</span><span class="token string">&quot;0000ff&quot;</span><span class="token punctuation">,</span>                            <span class="token comment"># 背景色，16进制rgb</span>
 <span class="token punctuation">)</span>

 patternType<span class="token punctuation">:</span>                                    <span class="token comment"># patternType 可选值</span>
     none、solid、darkGray、mediumGray、lightGray、
     lightDown、lightGray、lightGrid
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="边框" tabindex="-1"><a class="header-anchor" href="#边框" aria-hidden="true">#</a> 边框</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code> <span class="token keyword">from</span> openpyxl<span class="token punctuation">.</span>styles <span class="token keyword">import</span> Border<span class="token punctuation">,</span> Side

 side <span class="token operator">=</span> Side<span class="token punctuation">(</span>
   style<span class="token operator">=</span><span class="token string">&quot;medium&quot;</span><span class="token punctuation">,</span>                               <span class="token comment"># 边框样式</span>
   color<span class="token operator">=</span><span class="token string">&quot;ff66dd&quot;</span><span class="token punctuation">,</span>                               <span class="token comment"># 边框颜色，16进制rgb表示</span>
 <span class="token punctuation">)</span>

 style<span class="token punctuation">:</span>                                          <span class="token comment"># style 可选值</span>
     dashDot、dashDotDot、dashed、dotted、double、
     hair、medium、mediumDashDot、mediumDashDotDot、
     mediumDashed、slantDashDot、thick、thin

 cell<span class="token punctuation">.</span>border <span class="token operator">=</span> Border<span class="token punctuation">(</span>
    top<span class="token operator">=</span>side<span class="token punctuation">,</span>                                    <span class="token comment"># 上边框使用定义的 side</span>
    bottom<span class="token operator">=</span>side<span class="token punctuation">,</span>                                 <span class="token comment"># 下边框使用定义的 side</span>
    left<span class="token operator">=</span>side<span class="token punctuation">,</span>                                   <span class="token comment"># 左边框使用定义的 side</span>
    right<span class="token operator">=</span>side<span class="token punctuation">,</span>                                  <span class="token comment"># 右边框使用定义的 side</span>
    diagonal<span class="token operator">=</span>side                                <span class="token comment"># 对角线使用定义的 side</span>
<span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="对齐" tabindex="-1"><a class="header-anchor" href="#对齐" aria-hidden="true">#</a> 对齐</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code> <span class="token keyword">from</span> openpyxl<span class="token punctuation">.</span>styles <span class="token keyword">import</span> Alignment

 cell<span class="token punctuation">.</span>alignment <span class="token operator">=</span> Alignment<span class="token punctuation">(</span>
    horizontal<span class="token operator">=</span><span class="token string">&#39;left&#39;</span><span class="token punctuation">,</span>                           <span class="token comment"># 水平对齐，可选general、left、center、right、fill、justify、centerContinuous、distributed</span>
    vertical<span class="token operator">=</span><span class="token string">&#39;top&#39;</span><span class="token punctuation">,</span>                              <span class="token comment"># 垂直对齐， 可选top、center、bottom、justify、distributed</span>
    text_rotation<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>                             <span class="token comment"># 字体旋转，0~180整数</span>
    wrap_text<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>                             <span class="token comment"># 是否自动换行</span>
    shrink_to_fit<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>                         <span class="token comment"># 是否缩小字体填充</span>
    indent<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>                                    <span class="token comment"># 缩进值</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,24),o=[p];function l(c,i){return s(),a("div",null,o)}const d=n(t,[["render",l],["__file","python-openpyxl.html.vue"]]);export{d as default};
